$.extend({createUploadIframe:function(t,e){var a="jUploadFrame"+t,o='<iframe id="'+a+'" name="'+a+'" style="position:absolute; top:-9999px; left:-9999px"';return window.ActiveXObject&&("boolean"==typeof e?o+=' src="javascript:false"':"string"==typeof e&&(o+=' src="'+e+'"')),o+=" />",$(o).appendTo(document.body),$("#"+a).get(0)},createUploadForm:function(t,e,a){var o="jUploadForm"+t,n="jUploadFile"+t,r=$('<form  action="" method="POST" name="'+o+'" id="'+o+'" enctype="multipart/form-data"></form>');if(a)for(var d in a)$('<input type="hidden" name="'+d+'" value="'+a[d]+'" />').appendTo(r);var c=$("#"+e),l=$(c).clone();return $(c).attr("id",n),$(c).before(l),$(c).appendTo(r),$(r).css("position","absolute"),$(r).css("top","-1200px"),$(r).css("left","-1200px"),$(r).appendTo("body"),r},handleError:function(t,e,a,o){t.error&&t.error.call(t.context||t,e,a,o),t.global&&(t.context?$(t.context):$.event).trigger("ajaxError",[e,t,o])},ajaxFileUpload:function(t){t=$.extend({},$.ajaxSettings,t);var e=(new Date).getTime(),a=$.createUploadForm(e,t.fileElementId,void 0!==t.data&&t.data),o=($.createUploadIframe(e,t.secureuri),"jUploadFrame"+e),n="jUploadForm"+e;t.global&&!$.active++&&$.event.trigger("ajaxStart");var r=!1,d={};t.global&&$.event.trigger("ajaxSend",[d,t]);var c=function(e){var n=document.getElementById(o);try{n.contentWindow?(d.responseText=n.contentWindow.document.body?n.contentWindow.document.body.innerHTML:null,d.responseXML=n.contentWindow.document.XMLDocument?n.contentWindow.document.XMLDocument:n.contentWindow.document):n.contentDocument&&(d.responseText=n.contentDocument.document.body?n.contentDocument.document.body.innerHTML:null,d.responseXML=n.contentDocument.document.XMLDocument?n.contentDocument.document.XMLDocument:n.contentDocument.document)}catch(e){$.handleError(t,d,null,e)}if(d||"timeout"==e){r=!0;var c;try{if("error"!=(c="timeout"!=e?"success":"error")){var l=$.uploadHttpData(d,t.dataType);t.success&&t.success(l,c),t.global&&$.event.trigger("ajaxSuccess",[d,t])}else $.handleError(t,d,c)}catch(e){c="error",$.handleError(t,d,c,e)}t.global&&$.event.trigger("ajaxComplete",[d,t]),t.global&&!--$.active&&$.event.trigger("ajaxStop"),t.complete&&t.complete(d,c),$(n).unbind(),setTimeout(function(){try{$(n).remove(),$(a).remove()}catch(e){$.handleError(t,d,null,e)}},100),d=null}};t.timeout>0&&setTimeout(function(){r||c("timeout")},t.timeout);try{var a=$("#"+n);$(a).attr("action",t.url),$(a).attr("method","POST"),$(a).attr("target",o),a.encoding?$(a).attr("encoding","multipart/form-data"):$(a).attr("enctype","multipart/form-data"),$(a).submit()}catch(e){$.handleError(t,d,null,e)}return $("#"+o).load(c),{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;if(data="xml"==type||data?r.responseXML:r.responseText,data=data.replace("<pre>",""),data=data.replace("</pre>",""),"script"==type&&$.globalEval(data),"json"==type){data=r.responseText;var start=data.indexOf(">");if(start!=-1){var end=data.indexOf("<",start+1);end!=-1&&(data=data.substring(start+1,end))}eval("data = "+data)}return"html"==type&&$("<div>").html(data).evalScripts(),data}});